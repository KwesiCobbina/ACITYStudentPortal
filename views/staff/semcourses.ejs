<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Carousel Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/css/carousel.css" rel="stylesheet">
  </head>
  <body>

    <%- include('header.ejs') %>

    <main role="main">

      <!-- <div id="myCarousel" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
          <li data-target="#myCarousel" data-slide-to="1"></li>
          <li data-target="#myCarousel" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img class="first-slide" src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="First slide">
            <div class="container">
              <div class="carousel-caption text-left">
                <h1>Example headline.</h1>
                <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                <p><a class="btn btn-lg btn-primary" href="#" role="button">Sign up today</a></p>
              </div>
            </div>
          </div>
          <div class="carousel-item">
            <img class="second-slide" src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
            <div class="container">
              <div class="carousel-caption">
                <h1>Another example headline.</h1>
                <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                <p><a class="btn btn-lg btn-primary" href="#" role="button">Learn more</a></p>
              </div>
            </div>
          </div>
          <div class="carousel-item">
            <img class="third-slide" src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Third slide">
            <div class="container">
              <div class="carousel-caption text-right">
                <h1>One more for good measure.</h1>
                <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                <p><a class="btn btn-lg btn-primary" href="#" role="button">Browse gallery</a></p>
              </div>
            </div>
          </div>
        </div>
        <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div> -->


      <!-- Marketing messaging and featurettes
      ================================================== -->
      <!-- Wrap the rest of the page in another container to center all the content. -->

      <div class=" marketing">

        <!-- Three columns of text below the carousel -->
        <div class="container-fluid"><a href="/staff/programs"><button class="btn mt-3 btn-secondary">Back</button></a></div>
        <div class="row mt-5">
            <style>
                .year {
                    /* background-color: #e6e6e6; */
                    padding: 10px;
                    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.12) inset;
	border-color: -moz-use-text-color #FFFFFF #FFFFFF -moz-use-text-color;
	border-style: none solid solid none;
	border-width: medium 1px 1px medium;
	-moz-border-bottom-colors: none;
	-moz-border-image: none;
	-moz-border-left-colors: none;
	-moz-border-right-colors: none;
	-moz-border-top-colors: none;
                }
                .year .title {
                    font-size: 20px;
                    font-weight: bolder;
                    font-family: monospace;
                    text-align: center;
                    background: #333;
                    color: #fff;
                    margin-bottom: 16px;
                }
                .course {
                    display: flex;
                    padding: 10px;
                    border-radius: 10px;
                    margin-bottom: 5px;
                    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
	                  box-shadow: 0 1px 5px rgba(0, 0, 0, 0.15);
                }
                .course .inputg {
                    display: flex;
                    flex-direction: column;
                    margin-right: 10px;
                }
                .ovinput {
                    display: inline;
                    width: auto;
                }
                label {
                    font-weight: bold;
                }

                .item {
                  display: flex;
                  border: 1px solid rgba(0, 0, 0, 0.2);
                  padding: 5px;
                  justify-content: space-between;
                }
                .item .un {
                  display: flex;
                  flex-direction: column;
                }
                /* .item .copy {
                  height: inherit;
                  padding: 5px;
                  text-align: center;
                  border-radius: 5px;
                  color: #fff;
                  background-color: blue;
                } */
            </style>
          <div class="col-lg-3">
            <div class="ml-5">
              
              <label for="">Search for Course</label>
              <input type="text" class="form-control mb-3">
              <div class="result">
                <%cdata.forEach(i=>{%>
                <div class="item">
                  <div class="un">
                    <div class="name">
                      <%=i.name%>
                    </div>
                    <div class="code"><%=i.code%></div>
                  </div>
                  <button ref-data="<%=i.code%>" class="btn btn-primary copy">copy</button>
                </div>
                <%})%>
              </div>
            </div>
          </div>
					<div class="col-lg-6">
            <div class="alert-place"></div>
                        <h3><%= data.name %></h3>
                        <div class="ground"></div>
                        <form id="sem1" method="POST" action="" class="year">
                          <div class="title">1st Semester</div>
                          <div class="inputes">
                              <input type="text" name="code" value="<%=data._id%>" style="display: none">
                              <input type="text" name="year" value="<%=year%>" style="display: none">
                              <input type="text" name="sem" value="1" style="display: none">
                              <% sem1res.forEach(function(i){ %>
                                <div class="course">
                                  <div class="inputg">
                                      <label>Course code</label>
                                      <div class="input-group">
                                        <input class="form-control" value="<%=i.course.code%>" name="coursecode" type="text">
                                        <div class="input-group-append">
                                          <button class="btn btn-outline-secondary paster" type="button">Paste</button>
                                        </div>
                                      </div>
                                      
                                  </div>
                                  <div class="inputg">
                                      <label>Credits</label>
                                      <input type="text" name="credits" value="<%=i.credit%>" class="form-control">
                                  </div>
                                  <div class="inputg">
                                      <label>LecturerID</label>
                                      <div class="input-group">
                                        <input class="form-control" name="lecturerID" value="<%=i.lecturer.lecturerID%>" type="text">
                                        <div class="input-group-append">
                                          <button class="btn btn-outline-secondary paster" type="button">Paste</button>
                                        </div>
                                      </div>                                  </div>
                              </div>
                              <% }) %>
                          </div>
                          <button type="button" class="btn add-course">Add course</button>
                        </form>


                      <form id="sem2" method="POST" action="" class="year">
                        <div class="title">2nd Semester</div>
                        <div class="inputes">
                          <input type="text" name="code" value="<%=data._id%>" style="display: none">
                              <input type="text" name="year" value="<%=year%>" style="display: none">
                              <input type="text" name="sem" value="2" style="display: none">
                              <% sem2res.forEach(function(i){ %>
                                <div class="course">
                                  <div class="inputg">
                                      <label>Course code</label>
                                      <div class="input-group">
                                        <input class="form-control" value="<%=i.course.code%>" name="coursecode" type="text">
                                        <div class="input-group-append">
                                          <button class="btn btn-outline-secondary paster" type="button">Paste</button>
                                        </div>
                                      </div>                                  </div>
                                  <div class="inputg">
                                      <label>Credits</label>
                                      <input type="text" name="credits" value="<%=i.credit%>" class="form-control">
                                  </div>
                                  <div class="inputg">
                                      <label>LecturerID</label>
                                      <div class="input-group">
                                        <input class="form-control" name="lecturerID" value="<%=i.lecturer.lecturerID%>" type="text">
                                        <div class="input-group-append">
                                          <button class="btn btn-outline-secondary paster" type="button">Paste</button>
                                        </div>
                                      </div>
                                  </div>
                              </div>
                              <% }) %>
                        </div>
                        <button type="button" class="btn add-course">Add course</button>
                      </form>
                      <div class="text-center">
                        <button class="btn btn-primary m-5 save-courses">Save</button>
                      </div>
                      
          </div>
          <div class="col-lg-3">
            <div class="mr-5">
              <label for="">Search for Lecturer</label>
              <input type="text" class="form-control mb-3">
              <div class="result">
                <%ldata.forEach(i=>{%>
                <div class="item">
                  <div class="un">
                    <div class="name">
                      <%=i.firstname%> <%=i.surname%>
                    </div>
                    <div class="code"><%=i.lecturerID%></div>
                  </div>
                  <button ref-data="<%=i.lecturerID%>" class="btn btn-primary copy">copy</button>
                </div>
                <%})%>
              </div>
            </div>
          </div>
        </div><!-- /.row -->


        <!-- START THE FEATURETTES -->

        <!-- <hr class="featurette-divider">

        <div class="row featurette">
          <div class="col-md-7">
            <h2 class="featurette-heading">First featurette heading. <span class="text-muted">It'll blow your mind.</span></h2>
            <p class="lead">Donec ullamcorper nulla non metus auctor fringilla. Vestibulum id ligula porta felis euismod semper. Praesent commodo cursus magna, vel scelerisque nisl consectetur. Fusce dapibus, tellus ac cursus commodo.</p>
          </div>
          <div class="col-md-5">
            <img class="featurette-image img-fluid mx-auto" data-src="holder.js/500x500/auto" alt="Generic placeholder image">
          </div>
        </div>

        <hr class="featurette-divider">

        <div class="row featurette">
          <div class="col-md-7 order-md-2">
            <h2 class="featurette-heading">Oh yeah, it's that good. <span class="text-muted">See for yourself.</span></h2>
            <p class="lead">Donec ullamcorper nulla non metus auctor fringilla. Vestibulum id ligula porta felis euismod semper. Praesent commodo cursus magna, vel scelerisque nisl consectetur. Fusce dapibus, tellus ac cursus commodo.</p>
          </div>
          <div class="col-md-5 order-md-1">
            <img class="featurette-image img-fluid mx-auto" data-src="holder.js/500x500/auto" alt="Generic placeholder image">
          </div>
        </div>

        <hr class="featurette-divider">

        <div class="row featurette">
          <div class="col-md-7">
            <h2 class="featurette-heading">And lastly, this one. <span class="text-muted">Checkmate.</span></h2>
            <p class="lead">Donec ullamcorper nulla non metus auctor fringilla. Vestibulum id ligula porta felis euismod semper. Praesent commodo cursus magna, vel scelerisque nisl consectetur. Fusce dapibus, tellus ac cursus commodo.</p>
          </div>
          <div class="col-md-5">
            <img class="featurette-image img-fluid mx-auto" data-src="holder.js/500x500/auto" alt="Generic placeholder image">
          </div>
        </div>

        <hr class="featurette-divider"> -->

        <!-- /END THE FEATURETTES -->

      </div><!-- /.container -->


      <!-- FOOTER -->
      <footer class="container">
        <p class="float-right"><a href="#">Back to top</a></p>
        <p>&copy; Acity Portal 2020-2021 &middot; <a href="#">Privacy</a> &middot; <a href="#">Terms</a></p>
      </footer>
    </main>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
    
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/js/vendor/jquery-slim.min.js"><\/script>')</script>
    <script src="/js/vendor/popper.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <script src="/js/vendor/holder.min.js"></script>
    <script>
      const copyToClipboard = str => {
  const el = document.createElement('textarea');
  el.value = str;
  el.setAttribute('readonly', '');
  el.style.position = 'absolute';
  el.style.left = '-9999px';
  document.body.appendChild(el);
  el.select();
  document.execCommand('copy');
  document.body.removeChild(el);
};
$(".copy").click(function(){
  let el = $(this);
  copyToClipboard(el.attr('ref-data'));
  el.text('copied');
  el.removeClass('btn-primary').addClass('btn-success');
  setTimeout(function(){
    el.removeClass('btn-success').addClass('btn-primary');
    el.text('copy')
  },2000)
})
$(document).on('click','.paster',function(){
  navigator.clipboard.readText().then(d=>{
    $(this).parent().parent().children("input").val(d)
  }).catch(console.error)
  // console.log()
})
      let coursetemp = `<div class="course">
                                  <div class="inputg">
                                      <label>Course code</label>
                                      <div class="input-group">
                                        <input class="form-control" value="" name="coursecode" type="text">
                                        <div class="input-group-append">
                                          <button class="btn btn-outline-secondary paster" type="button">Paste</button>
                                        </div>
                                      </div>
                                  </div>
                                  <div class="inputg">
                                      <label>Credits</label>
                                      <input type="text" name="credits" class="form-control">
                                  </div>
                                  <div class="inputg">
                                      <label>LecturerID</label>
                                      <div class="input-group">
                                        <input class="form-control" value="" name="lecturerID" type="text">
                                        <div class="input-group-append">
                                          <button class="btn btn-outline-secondary paster" type="button">Paste</button>
                                        </div>
                                      </div>
                                  </div>
                              </div>`;
      function getyear(year){
          return `<div class="year year${year}">
                            <div class="title">Year ${year}</div>
                            <div class="inputes"></div>
                            <button class="btn add-course">Add course</button>
                            </div>
                            `
      }
      let year = 1;
      $(".add-year").click(function(){
        // $(".ground").append(getyear(year++));
        $(".ground").before(getyear(year++));
      })
      $(document).on("click",".add-course",function(){
        $(this).parent().children(".inputes").append(coursetemp);
      })
      $(".save-courses").click(function(){
        let a = $("#sem1").serializeArray();
        let b = $("#sem2").serializeArray();
        // do something else
        let arr = [];
        for(let i=3;i<a.length;i+=3){
          arr.push({
            programID: a[0].value,
            year: a[1].value * 1,
            semester: a[2].value * 1,
            course: a[i].value,
            credit: a[i+1].value * 1,
            lecturer: a[i+2].value
          })
        }
        for(let i=3;i<b.length;i+=3){
          arr.push({
            programID: b[0].value,
            year: b[1].value * 1,
            semester: b[2].value * 1,
            course: b[i].value,
            credit: b[i+1].value * 1,
            lecturer: b[i+2].value
          })
        }
        // putting sem1 into an array
        // let sem1c = []; let sem1cr = []; let sem1l = [];
        // a.forEach(i=>{
        //   if(i.name=="coursecode") sem1c.push(i.value)
        //   else if(i.name=="credits") sem1cr.push(i.value)
        //   else if(i.name=="lecturerID") sem1l.push(i.value)
        // })
        // // putting sem2 into an array
        // let sem2c = []; let sem2cr = []; let sem2l = [];
        // b.forEach(i=>{
        //   if(i.name=="coursecode") sem2c.push(i.value)
        //   else if(i.name=="credits") sem2cr.push(i.value)
        //   else if(i.name=="lecturerID") sem2l.push(i.value)
        // })
        // let data = {
        //   code: "<%=code%>",
        //   year: "<%=year%>",
        //   courses1: sem1c,
        //   credits1: sem1cr,
        //   lecturers1: sem1l,
        //   courses2: sem2c,
        //   credits2: sem2cr,
        //   lecturers2: sem2l,
        // }
        let data = JSON.stringify(arr);
        $.ajax({
          method: "POST",
          url: "/staff/semcourses",
          data: {data},
          success: function(r){
            let tempp = `<div class="alert alert-primary">Saved successfully!</div>`;
            $(".alert-place").append(tempp);
            setTimeout(function(){
              $(".alert-place").html("");
            },2000)
            console.log(r);
          }
        })
      })
    </script>
  </body>
</html>
